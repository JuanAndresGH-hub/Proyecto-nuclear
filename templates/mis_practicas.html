{% extends 'base.html' %}

{% block title %}Mis Prácticas - Sistema de Gestión de Prácticas{% endblock %}

{% block topbar_title %}Mis Prácticas{% endblock %}

{% block content %}
<div class="page-header">
    <h1><i class="fas fa-book"></i> Mis Prácticas</h1>
    <p>Gestiona todas tus prácticas empresariales</p>
</div>

<div class="row mb-4">
    <div class="col-md-4">
        <div class="card" style="border-top: 3px solid #212529;">
            <div class="card-body text-center">
                <h2 style="font-size: 2rem; color: #212529; margin-bottom: 10px;">{{ total_practicas }}</h2>
                <h5 style="color: #495057;">Prácticas Totales</h5>
                <p class="text-muted" style="margin: 0;">De 5 permitidas</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card" style="border-top: 3px solid #198754;">
            <div class="card-body text-center">
                <h2 style="font-size: 2rem; color: #198754; margin-bottom: 10px;">{{ practicas_aprobadas }}</h2>
                <h5 style="color: #495057;">Prácticas Aprobadas</h5>
                <p class="text-muted" style="margin: 0;">Promedio ≥ 3.5</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card" style="border-top: 3px solid #0dcaf0;">
            <div class="card-body text-center">
                <h2 style="font-size: 2rem; color: #0dcaf0; margin-bottom: 10px;">{{ total_practicas|add:"-1" }}</h2>
                <h5 style="color: #495057;">Prácticas Disponibles</h5>
                <p class="text-muted" style="margin: 0;">Aún por realizar</p>
            </div>
        </div>
    </div>
</div>

{% if practicas %}
    <div class="row">
        {% for practica in practicas %}
            <div class="col-lg-6 mb-4">
                <div class="card" style="height: 100%;">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h5 class="card-title" style="margin-bottom: 5px;">
                                    <i class="fas fa-graduation-cap"></i> Práctica {{ practica.numero }}
                                </h5>
                                {% if practica.vacante %}
                                    <small style="color: #6c757d;">{{ practica.vacante.empresa.nombre }}</small>
                                {% endif %}
                            </div>
                            <span class="badge" style="
                                {% if practica.estado == 'EN_CURSO' %}
                                    background-color: #cfe2ff; color: #084298;
                                {% elif practica.estado == 'FINALIZADA' %}
                                    background-color: #d1f0e3; color: #0f5130;
                                {% elif practica.estado == 'NO_INICIADA' %}
                                    background-color: #f8f9fa; color: #495057;
                                {% elif practica.estado == 'REPROBADA' %}
                                    background-color: #f8d7da; color: #842029;
                                {% endif %}
                                padding: 6px 12px; font-size: 0.8rem;">
                                {{ practica.get_estado_display }}
                            </span>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                            {% if practica.fecha_inicio %}
                                <div>
                                    <small style="color: #6c757d; display: block; margin-bottom: 5px;">
                                        <i class="fas fa-calendar-alt"></i> Fecha Inicio
                                    </small>
                                    <p style="margin: 0; color: #212529; font-weight: 500;">{{ practica.fecha_inicio|date:"d/m/Y" }}</p>
                                </div>
                            {% endif %}

                            {% if practica.fecha_fin %}
                                <div>
                                    <small style="color: #6c757d; display: block; margin-bottom: 5px;">
                                        <i class="fas fa-calendar-check"></i> Fecha Fin
                                    </small>
                                    <p style="margin: 0; color: #212529; font-weight: 500;">{{ practica.fecha_fin|date:"d/m/Y" }}</p>
                                </div>
                            {% endif %}
                        </div>

                        {% if practica.promedio_final %}
                            <div style="margin: 15px 0; padding: 12px; background: #f8f9fa; border-left: 3px solid #212529; border-radius: 4px;">
                                <small style="color: #6c757d; display: block; margin-bottom: 5px;">
                                    <i class="fas fa-chart-bar"></i> Promedio Final
                                </small>
                                <h4 style="margin: 0; color: {% if practica.promedio_final >= 3.5 %}#198754{% else %}#dc3545{% endif %};">
                                    {{ practica.promedio_final }}/5.0
                                </h4>
                            </div>
                        {% endif %}

                        {% if practica.observaciones %}
                            <div style="margin-top: 12px; padding: 12px; background: #fffbea; border-left: 3px solid #ffc107; border-radius: 4px;">
                                <small style="color: #6c757d;">Observaciones:</small>
                                <p style="margin: 5px 0 0 0; color: #212529; font-size: 0.9rem;">{{ practica.observaciones }}</p>
                            </div>
                        {% endif %}
                    </div>

                    <div style="border-top: 1px solid #e9ecef; padding: 15px;">
                        <a href="{% url 'usuarios:detalle_practica' practica.pk %}" class="btn btn-sm btn-dark w-100">
                            <i class="fas fa-eye"></i> Ver Detalles
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="card">
        <div class="card-body" style="text-align: center; padding: 60px 20px;">
            <i class="fas fa-inbox" style="font-size: 3rem; color: #dee2e6; margin-bottom: 20px; display: block; opacity: 0.7;"></i>
            <h5 style="color: #212529; margin-bottom: 10px;">No hay prácticas registradas</h5>
            <p style="color: #6c757d; margin-bottom: 20px;">Aún no tienes prácticas asignadas. Contacta con tu coordinador.</p>
        </div>
    </div>
{% endif %}

{% endblock %}

